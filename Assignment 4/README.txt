Needs a lot of cleaning and improving but it works as asked!

MD5 Hash is 0 user doesn't have permisssion to access the file.

I used two linked lists for Step 2, one for the potentially malicious users and one for the file modifications.